<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Visualize_Logs.objects.CuckooJSONReport &#8212; Visualize_Logs 20161111.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '20161111.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="top" title="Visualize_Logs 20161111.1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for Visualize_Logs.objects.CuckooJSONReport</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Includes</span>
<span class="c1">#</span>

<span class="c1"># NetworkX</span>
<span class="kn">import</span> <span class="nn">networkx</span>

<span class="c1"># OS</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># Plotly</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="k">import</span> <span class="n">plot</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="k">import</span> <span class="n">Bar</span><span class="p">,</span> <span class="n">Scatter</span><span class="p">,</span> <span class="n">Figure</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> \
    <span class="n">Line</span><span class="p">,</span> <span class="n">Marker</span><span class="p">,</span> <span class="n">Annotations</span><span class="p">,</span> <span class="n">Annotation</span><span class="p">,</span> <span class="n">XAxis</span><span class="p">,</span> <span class="n">YAxis</span>

<span class="c1"># Regular Expressions</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># JSON</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Exceptions</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">Exceptions</span>

<span class="c1">#</span>
<span class="c1"># Classes</span>
<span class="c1">#</span>


<div class="viewcode-block" id="CuckooJSONReport"><a class="viewcode-back" href="../../../Visualize_Logs.objects.html#Visualize_Logs.objects.CuckooJSONReport.CuckooJSONReport">[docs]</a><span class="k">class</span> <span class="nc">CuckooJSONReport</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to hold Cuckoo-Modified JSON reports.</span>

<span class="sd">    https://github.com/spender-sandbox/cuckoo-modified</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">jsonreportfile</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;The JSON report file path.&quot;&quot;&quot;</span>

    <span class="n">jsonreportdata</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;This holds the actual data of the JSON report.&quot;&quot;&quot;</span>

    <span class="n">DiGraph</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;This holds the Networkx digraph to be plotted.&quot;&quot;&quot;</span>

    <span class="n">graphvizprog</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;This is the graphviz program used to generate the layout.&quot;&quot;&quot;</span>

    <span class="n">nodemetadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;This is a dict that will hold dicts of metadata for each node.&quot;&quot;&quot;</span>

    <span class="n">edgemetadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;This is a dict of (edge1,edge2) that will hold dicts of metadata</span>
<span class="sd">    for each edge.&quot;&quot;&quot;</span>

    <span class="n">rootpid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;This is the pid (Node) on top.&quot;&quot;&quot;</span>

    <span class="n">ignorepaths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;List of regular expressions to ignore in file or registry data.&quot;&quot;&quot;</span>

    <span class="n">includepaths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="sd">&quot;&quot;&quot;List of regular expressions to include in file or registry data.&quot;&quot;&quot;</span>

    <span class="n">IPProto</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_IP&#39;</span><span class="p">,</span>
                <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_ICMP&#39;</span><span class="p">,</span>
                <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_IGMP&#39;</span><span class="p">,</span>
                <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_TCP&#39;</span><span class="p">,</span>
                <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_EGP&#39;</span><span class="p">,</span>
                <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_PUP&#39;</span><span class="p">,</span>
                <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_UDP&#39;</span><span class="p">,</span>
                <span class="mi">29</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_IDP&#39;</span><span class="p">,</span>
                <span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_DCCP&#39;</span><span class="p">,</span>
                <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_IPV6&#39;</span><span class="p">,</span>
                <span class="mi">46</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_RSVP&#39;</span><span class="p">,</span>
                <span class="mi">47</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_GRE&#39;</span><span class="p">,</span>
                <span class="mi">50</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_ESP&#39;</span><span class="p">,</span>
                <span class="mi">51</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_AH&#39;</span><span class="p">,</span>
                <span class="mi">92</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_MTP&#39;</span><span class="p">,</span>
                <span class="mi">94</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_BEETPH&#39;</span><span class="p">,</span>
                <span class="mi">98</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_ENCAP&#39;</span><span class="p">,</span>
                <span class="mi">103</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_PIM&#39;</span><span class="p">,</span>
                <span class="mi">108</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_COMP&#39;</span><span class="p">,</span>
                <span class="mi">132</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_SCTP&#39;</span><span class="p">,</span>
                <span class="mi">136</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_UDPLITE&#39;</span><span class="p">,</span>
                <span class="mi">137</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_MPLS&#39;</span><span class="p">,</span>
                <span class="mi">255</span><span class="p">:</span> <span class="s1">&#39;IPPROTO_RAW&#39;</span>
                <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Information available:</span>
<span class="sd">    http://lxr.free-electrons.com/source/include/uapi/linux/in.h&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jsonreportfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">plotnetwork</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfiles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfilecreates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfiledeletes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfilemoves</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfilecopies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfilewrites</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotfilereads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotregistry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotregistrywrites</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotregistryreads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotregistrydeletes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">plotregistrycreates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">ignorepaths</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">includepaths</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The JSON report file is read and parsed using this class.  This</span>
<span class="sd">        could take a whiel depending on how big your JSON report is.</span>

<span class="sd">        This has been tested with the cuckoo-modifed version, but it may</span>
<span class="sd">        work with Cuckoo (proper) as well.</span>

<span class="sd">        :param jsonreportfile: The path to the JSON report file.</span>
<span class="sd">        :type jsonreportfile: A string.</span>
<span class="sd">        :param plotnetwork: Set to False to ignore network activity.</span>
<span class="sd">        :param plotfiles: Set to False to ignore file activity.</span>
<span class="sd">        :param plotfilecreates: Set to False to ignore file creates.</span>
<span class="sd">        :param plotfiledeletes: Set to False to ignore file deletes.</span>
<span class="sd">        :param plotfilemoves: Set to False to ignore file moves.</span>
<span class="sd">        :param plotfilecopies: Set to False to ignore file copies.</span>
<span class="sd">        :param plotfilewrites: Set to False to ignore file writes.</span>
<span class="sd">        :param plotfilereads: Set to False to ignore file reads.</span>
<span class="sd">        :param plotregistry: Set to False to ignore registry activity.</span>
<span class="sd">        :param plotregistrywrites: Set to False to ignore registry writes.</span>
<span class="sd">        :param plotregistryreads: Set to False to ignore registry reads.</span>
<span class="sd">        :param plotregistrydeletes: Set to False to ignore registry deletes.</span>
<span class="sd">        :param plotregistrycreates: Set to False to ignore registry creates.</span>
<span class="sd">        :param ignorepaths: A list of regular expressions to ignore for</span>
<span class="sd">            files and registry values.</span>
<span class="sd">        :param includepaths: A list of regular expressions to include for</span>
<span class="sd">            files and registry values.  Overrides ignore paths.</span>
<span class="sd">        :returns: An object.</span>
<span class="sd">        :rtype: CuckooJSONReport object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotfilecreates</span> <span class="o">=</span> <span class="n">plotfilecreates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotfiledeletes</span> <span class="o">=</span> <span class="n">plotfiledeletes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotfilemoves</span> <span class="o">=</span> <span class="n">plotfilemoves</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotfilecopies</span> <span class="o">=</span> <span class="n">plotfilecopies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotfilewrites</span> <span class="o">=</span> <span class="n">plotfilewrites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotfilereads</span> <span class="o">=</span> <span class="n">plotfilereads</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotregistrywrites</span> <span class="o">=</span> <span class="n">plotregistrywrites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotregistryreads</span> <span class="o">=</span> <span class="n">plotregistryreads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotregistrydeletes</span> <span class="o">=</span> <span class="n">plotregistrydeletes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotregistrycreates</span> <span class="o">=</span> <span class="n">plotregistrycreates</span>

        <span class="k">if</span> <span class="n">ignorepaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ignorepaths</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span> <span class="o">=</span> <span class="n">ignorepaths</span>

        <span class="k">if</span> <span class="n">includepaths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">includepaths</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span> <span class="o">=</span> <span class="n">includepaths</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jsonreportfile</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">Exceptions</span><span class="o">.</span><span class="n">VisualizeLogsInvalidFile</span><span class="p">(</span><span class="n">jsonreportfile</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jsonreportfile</span> <span class="o">=</span> <span class="n">jsonreportfile</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonreportfile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">jsonfile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jsonreportdata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">jsonfile</span><span class="p">)</span>

        <span class="c1"># Create a network graph...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

        <span class="c1"># Add all the processes to the graph...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_all_processes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plotnetwork</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Add network activity to the graph...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_network_activity</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plotfiles</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Add file activity to the graph...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_activity</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">plotregistry</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Add registry activity to the graph...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_registry_activity</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_search_re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">expressions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to check if string is selected</span>
<span class="sd">        by regular expressions in expression list.</span>
<span class="sd">        Ignores case!</span>

<span class="sd">        :param string:  String to search.</span>
<span class="sd">        :param expressions: List of regular expressions to search.</span>
<span class="sd">        :returns: True if expressions fire on string, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_add_all_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add processess from JSON report</span>
<span class="sd">        process tree.</span>

<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processtree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsonreportdata</span><span class="p">[</span><span class="s1">&#39;behavior&#39;</span><span class="p">][</span><span class="s1">&#39;processtree&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsonreportdata</span><span class="p">[</span><span class="s1">&#39;behavior&#39;</span><span class="p">][</span><span class="s1">&#39;processes&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rootpid</span> <span class="o">=</span> <span class="s2">&quot;PID </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_processtree</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;pid&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">process</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processtree</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_processes_recursive</span><span class="p">(</span><span class="n">process</span><span class="p">)</span>

        <span class="c1"># Add the rest of the metadata...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_process_metadata</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_processes_recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">processtreedict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add processes recursively from</span>
<span class="sd">        a dict representing the JSON process tree.</span>

<span class="sd">        :param processtreedict:  A dict of data from the process tree.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">processtreedict</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span>
        <span class="n">ppid</span> <span class="o">=</span> <span class="n">processtreedict</span><span class="p">[</span><span class="s1">&#39;parent_id&#39;</span><span class="p">]</span>
        <span class="n">nodename</span> <span class="o">=</span> <span class="s2">&quot;PID </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">ppid_node</span> <span class="o">=</span> <span class="s2">&quot;PID </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ppid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">nodename</span><span class="p">,</span>
                              <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;PID&#39;</span><span class="p">,</span>
                              <span class="n">pid</span><span class="o">=</span><span class="n">pid</span><span class="p">,</span>
                              <span class="n">parent_id</span><span class="o">=</span><span class="n">ppid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;PID&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;parent_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ppid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;threads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processtreedict</span><span class="p">[</span><span class="s1">&#39;threads&#39;</span><span class="p">]</span>
        <span class="c1"># self.nodemetadata[nodename][&#39;environ&#39;] = processtreedict[&#39;environ&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processtreedict</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;module_path&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">processtreedict</span><span class="p">[</span><span class="s1">&#39;module_path&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ppid_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ppid_node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ppid_node</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;PID&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ppid_node</span><span class="p">][</span><span class="s1">&#39;children&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ppid_node</span><span class="p">][</span><span class="s1">&#39;cmdline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ppid_node</span><span class="p">][</span><span class="s1">&#39;children&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodename</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ppid_node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">ppid_node</span><span class="p">,</span> <span class="n">nodename</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">processtreedict</span><span class="p">[</span><span class="s1">&#39;children&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_processes_recursive</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_process_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that ties the extra process metadata</span>
<span class="sd">        to the nodemetadata dict.</span>

<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">process</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span><span class="p">:</span>
            <span class="n">nodename</span> <span class="o">=</span> <span class="s2">&quot;PID </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">process</span><span class="p">[</span><span class="s1">&#39;process_id&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;first_seen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">process</span><span class="p">[</span><span class="s1">&#39;first_seen&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span> <span class="o">=</span>\
                <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">process</span><span class="p">[</span><span class="s1">&#39;calls&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                <span class="n">pandas</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span> <span class="o">=</span>\
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>

            <span class="n">calls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">nodename</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span>

            <span class="n">createprocs</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CreateProcessInternalW&#39;</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">createproc</span> <span class="ow">in</span> <span class="n">createprocs</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">childpid</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">cmdline</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">createproc</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ProcessId&#39;</span><span class="p">:</span>
                        <span class="n">childpid</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CommandLine&#39;</span><span class="p">:</span>
                        <span class="n">cmdline</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">cmdline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">cmdline</span> <span class="o">=</span> <span class="s2">&quot;Not Available&quot;</span>

                <span class="k">if</span> <span class="n">childpid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">childnode</span> <span class="o">=</span> <span class="s2">&quot;PID </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">childpid</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">childnode</span><span class="p">][</span><span class="s1">&#39;cmdline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmdline</span>

    <span class="k">def</span> <span class="nf">_add_file_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds file data to the graph.</span>
<span class="sd">        Assumes processes have already been plotted.</span>

<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;calls&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                    <span class="n">calls</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span>

                    <span class="c1"># Get file creates...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotfilecreates</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_creates</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="c1"># Get file writes...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotfilewrites</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_writes</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="c1"># Get file reads...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotfilereads</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_reads</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="c1"># Get file copies...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotfilecopies</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_copies</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="c1"># Get file deletes...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotfiledeletes</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_deletes</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="c1"># Get file moves...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotfilemoves</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_file_moves</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="c1"># Connect PIDs to files</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_connect_file_to_pid</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_connect_file_to_pid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that will connect files to PIDs.</span>

<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                    <span class="s1">&#39;module_path&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">]):</span>
                <span class="n">pidpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;module_path&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">linknode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">linknode</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">:</span>
                        <span class="n">filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">linknode</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">pidpath</span> <span class="o">==</span> <span class="n">filepath</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">linknode</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_file_moves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds the file moves in the calls</span>
<span class="sd">        for the PID node.</span>

<span class="sd">        :param node: PID node name.</span>
<span class="sd">        :param calls:  Calls for node.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filemoves</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MoveFileW&#39;</span><span class="p">)</span> <span class="o">|</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MoveFileA&#39;</span><span class="p">)</span> <span class="o">|</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MoveFileWithProgressW&#39;</span><span class="p">)</span> <span class="o">|</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MoveFileWithProgressA&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">filemove</span> <span class="ow">in</span> <span class="n">filemoves</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">existingfilename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">newfilename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">filemove</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ExistingFileName&#39;</span><span class="p">:</span>
                    <span class="n">existingfilename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NewFileName&#39;</span><span class="p">:</span>
                    <span class="n">newfilename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">newfilename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">newfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">newfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>

                <span class="n">newfilenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">newfilename</span><span class="p">)</span>
                <span class="n">existingfilenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">existingfilename</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">fmnodename</span> <span class="o">=</span> <span class="s2">&quot;FILE MOVE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fmnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fmnodename</span><span class="p">][</span><span class="s1">&#39;existingfile&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">existingfilename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fmnodename</span><span class="p">][</span><span class="s1">&#39;newfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newfilename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fmnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILEMOVE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fmnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">filemove</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fmnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILEMOVE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">fmnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fmnodename</span><span class="p">,</span> <span class="n">newfilenodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fmnodename</span><span class="p">,</span> <span class="n">existingfilenodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_file_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds the file copies in the calls</span>
<span class="sd">        for the PID node.</span>

<span class="sd">        :param node: PID node name.</span>
<span class="sd">        :param calls:  Calls for node.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filecopies</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CopyFileW&#39;</span><span class="p">)</span> <span class="o">|</span>
                            <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CopyFileA&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">filecreate</span> <span class="ow">in</span> <span class="n">filecopies</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">existedbefore</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">existingfilename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">newfilename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">filecreate</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ExistingFileName&#39;</span><span class="p">:</span>
                    <span class="n">existingfilename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ExistedBefore&#39;</span><span class="p">:</span>
                    <span class="n">existedbefore</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NewFileName&#39;</span><span class="p">:</span>
                    <span class="n">newfilename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">newfilename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">newfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">newfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">existingfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="ow">not</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">existingfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">newfilenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">newfilename</span><span class="p">)</span>
                <span class="n">existingfilenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">existingfilename</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">fcnodename</span> <span class="o">=</span> <span class="s2">&quot;FILE COPY </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;existingfile&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">existingfilename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;newfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newfilename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILECOPY&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;existedbefore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">existedbefore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">filecreate</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fcnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILECOPY&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">fcnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fcnodename</span><span class="p">,</span> <span class="n">newfilenodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fcnodename</span><span class="p">,</span> <span class="n">existingfilenodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_file_deletes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds the file deletes in the calls</span>
<span class="sd">        for the PID node.</span>

<span class="sd">        :param node: PID node name.</span>
<span class="sd">        :param calls:  Calls for node.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filedeletes</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DeleteFileW&#39;</span><span class="p">)</span> <span class="o">|</span>
                             <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DeleteFileA&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                            <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">filedelete</span> <span class="ow">in</span> <span class="n">filedeletes</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">filedelete</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FileName&#39;</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">filenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">fdnodename</span> <span class="o">=</span> <span class="s2">&quot;FILE DELETE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fdnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fdnodename</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fdnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILEDELETE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fdnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">filedelete</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fdnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILEDELETE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">fdnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fdnodename</span><span class="p">,</span> <span class="n">filenodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_file_creates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds the file creates in the calls</span>
<span class="sd">        for the PID node.</span>

<span class="sd">        :param node: PID node name.</span>
<span class="sd">        :param calls:  Calls for node.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filecreates</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtCreateFile&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                            <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">filecreate</span> <span class="ow">in</span> <span class="n">filecreates</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">existedbefore</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">desiredaccess</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">createdisposition</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">fileattribtes</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">filecreate</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FileName&#39;</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ExistedBefore&#39;</span><span class="p">:</span>
                    <span class="n">existedbefore</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DesiredAccess&#39;</span><span class="p">:</span>
                    <span class="n">desiredaccess</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CreateDisposition&#39;</span><span class="p">:</span>
                    <span class="n">createdisposition</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FileAttributes&#39;</span><span class="p">:</span>
                    <span class="n">fileattribtes</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">filenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">fcnodename</span> <span class="o">=</span> <span class="s2">&quot;FILE CREATE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILECREATE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;existedbefore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">existedbefore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;desiredaccess&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desiredaccess</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;createdisposition&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">createdisposition</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;fileattribtes&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">fileattribtes</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fcnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">filecreate</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fcnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILECREATE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">fcnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fcnodename</span><span class="p">,</span> <span class="n">filenodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_file_writes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds the file writes in the calls for</span>
<span class="sd">        the PID node.</span>

<span class="sd">        :param node:  PID node name.</span>
<span class="sd">        :param calls:  Calls for node.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filewrites</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtWriteFile&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">filewrite</span> <span class="ow">in</span> <span class="n">filewrites</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">filewrite</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HandleName&#39;</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">filenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">fwnodename</span> <span class="o">=</span> <span class="s2">&quot;FILE WRITE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fwnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fwnodename</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fwnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILEWRITE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">fwnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">filewrite</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">fwnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILEWRITE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">fwnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fwnodename</span><span class="p">,</span> <span class="n">filenodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_file_reads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds the file reads in the calls for</span>
<span class="sd">        the PID node.</span>

<span class="sd">        :param node:  PID node name.</span>
<span class="sd">        :param calls:  Calls for node.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filereads</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtReadFile&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fileread</span> <span class="ow">in</span> <span class="n">filereads</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">fileread</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HandleName&#39;</span><span class="p">:</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">filenodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">frnodename</span> <span class="o">=</span> <span class="s2">&quot;FILE READ </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">frnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">frnodename</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">frnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILEREAD&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">frnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">fileread</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">frnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILEREAD&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">frnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">frnodename</span><span class="p">,</span> <span class="n">filenodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_network_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds network data to the graph.</span>
<span class="sd">        Assumes processes have already been plotted.</span>

<span class="sd">        :returns:  Nothin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domains</span> <span class="o">=</span>\
            <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonreportdata</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">][</span><span class="s1">&#39;domains&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dns</span> <span class="o">=</span>\
            <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonreportdata</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">][</span><span class="s1">&#39;dns&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dns</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dns</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dns</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;answers&#39;</span><span class="p">]</span> <span class="o">=</span>\
                <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dns</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;answers&#39;</span><span class="p">])</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;calls&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                    <span class="n">calls</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span>

                    <span class="c1"># Get DNS lookups...</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_dns_lookups</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>
                    <span class="c1"># Add socket activity...</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_sockets</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_dns_lookups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add DNS lookups to the graph.</span>

<span class="sd">        :param node: The node name for the calls.</span>
<span class="sd">        :param calls:  A pandas.DataFrame of process calls.</span>
<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dnslookups</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gethostbyname&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lookup</span> <span class="ow">in</span> <span class="n">dnslookups</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">hostname</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">lookup</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Name&#39;</span><span class="p">:</span>
                    <span class="n">hostname</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">hostname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hostnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_host</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">hostnodename</span><span class="p">)</span>

                <span class="n">dns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dns</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">dns</span><span class="p">[</span><span class="s1">&#39;request&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">hostname</span><span class="p">)]</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dns</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;answers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
                            <span class="n">ipnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">hostnodename</span><span class="p">,</span> <span class="n">ipnodename</span><span class="p">)</span>

                <span class="c1"># ips = self.domains[self.domains[&#39;domain&#39;] == hostname]</span>

                <span class="c1"># for j, ip in ips.iterrows():</span>
                <span class="c1">#     ipnodename = self._add_ip(ip[&#39;ip&#39;])</span>
                <span class="c1">#     self.digraph.add_edge(hostnodename, ipnodename)</span>

    <span class="k">def</span> <span class="nf">_add_host</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add a host if it does not exist.</span>

<span class="sd">        :param host: Host name.</span>
<span class="sd">        :returns: Node name for the host.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hostnodename</span> <span class="o">=</span> <span class="s2">&quot;HOST </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hostnodename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">hostnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">hostnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;IP&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">hostnodename</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">host</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">hostnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;HOST&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hostnodename</span>

    <span class="k">def</span> <span class="nf">_add_ip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add an IP if it does not exist.</span>

<span class="sd">        :param ip: IP address.</span>
<span class="sd">        :returns: Node name for the IP address.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ipnodename</span> <span class="o">=</span> <span class="s1">&#39;&quot;IP </span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ipnodename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ipnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ipnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;IP&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">ipnodename</span><span class="p">][</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ipnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;IP&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ipnodename</span>

    <span class="k">def</span> <span class="nf">_add_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add a file if it does not exist.</span>

<span class="sd">        :param ip: File path.</span>
<span class="sd">        :returns: Node name for the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">origfilename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">filenodename</span> <span class="o">=</span> <span class="s1">&#39;&quot;FILE </span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filenodename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">filenodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">filenodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FILE&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">filenodename</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">origfilename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">filenodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;FILE&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filenodename</span>

    <span class="k">def</span> <span class="nf">_add_reg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">registry</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add a registry if it does not exsit.</span>

<span class="sd">        :param registry:  Registry</span>
<span class="sd">        :returns: Noe name for the registry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">regnodename</span> <span class="o">=</span> <span class="s1">&#39;&quot;REGISTRY </span><span class="si">{0}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">registry</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">regnodename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">regnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">regnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;REGISTRY&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">regnodename</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">registry</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">regnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;REGISTRY&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">regnodename</span>

    <span class="k">def</span> <span class="nf">_add_sockets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add Sockets to the graph.</span>

<span class="sd">        :param node:  The node name for the calls.</span>
<span class="sd">        :param calls:  A pandas.DataFrame of process calls.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sockets</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;socket&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sock</span> <span class="ow">in</span> <span class="n">sockets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">socketid</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">socketproto</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">sock</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;socket&#39;</span><span class="p">:</span>
                    <span class="n">socketid</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">IPProto</span><span class="p">:</span>
                        <span class="n">socketproto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IPProto</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">socketproto</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">socketid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="c1"># Sockets can be reused...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>

                <span class="n">socketname</span> <span class="o">=</span> <span class="s1">&#39;SOCKET </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">socketname</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;SOCKET&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">socketname</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">socketname</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SOCKET&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">socketname</span><span class="p">][</span><span class="s1">&#39;socket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">socketid</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">socketname</span><span class="p">][</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">socketproto</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">socketname</span><span class="p">][</span><span class="s1">&#39;opentime&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">sock</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>

                <span class="n">closesockets</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;closesocket&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                                     <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sock</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">closetime</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">closesockets</span><span class="o">.</span><span class="n">iterrows</span><span class="p">())[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="n">closetime</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">socketname</span><span class="p">][</span><span class="s1">&#39;closetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">closetime</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">socketname</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_add_tcp_connects</span><span class="p">(</span><span class="n">socketname</span><span class="p">,</span> <span class="n">calls</span><span class="p">,</span> <span class="n">socketid</span><span class="p">,</span>
                                       <span class="n">sock</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">closetime</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_tcp_connects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">,</span> <span class="n">socketid</span><span class="p">,</span> <span class="n">opentime</span><span class="p">,</span> <span class="n">closetime</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to add TCP connections to the graph.</span>

<span class="sd">        :param node:  The socket node name for the calls.</span>
<span class="sd">        :param calls:  A pandas.DataFrame of process calls.</span>
<span class="sd">        :param socketid:  The socket opened for these connections.</span>
<span class="sd">        :param opentime:  The time the socket opened.</span>
<span class="sd">        :param closetime:  The time the socket closed.</span>
<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">closetime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tcpconnects</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;connect&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                                <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">opentime</span><span class="p">)</span> <span class="o">&amp;</span>
                                <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">closetime</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tcpconnects</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;connect&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
                                <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">opentime</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tcpconnect</span> <span class="ow">in</span> <span class="n">tcpconnects</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">PlotConnect</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">tcpconnect</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;socket&#39;</span> <span class="ow">and</span>
                        <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">socketid</span><span class="p">):</span>
                    <span class="n">PlotConnect</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">PlotConnect</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">ipaddr</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">socketid</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">port</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">tcpconnect</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ip&#39;</span><span class="p">:</span>
                        <span class="n">ipaddr</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;socket&#39;</span><span class="p">:</span>
                        <span class="n">socketid</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span>
                        <span class="n">port</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">ipaddr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ipnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ip</span><span class="p">(</span><span class="n">ipaddr</span><span class="p">)</span>

                    <span class="c1"># Get a sequential number for the event...</span>
                    <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>

                    <span class="n">connnodename</span> <span class="o">=</span> <span class="s1">&#39;TCP CONNECT </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">connnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;TCPCONNECT&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">connnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">connnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span>\
                        <span class="s2">&quot;TCPCONNECT&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">connnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                        <span class="n">tcpconnect</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">connnodename</span><span class="p">][</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ipaddr</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">connnodename</span><span class="p">][</span><span class="s1">&#39;socket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">socketid</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">connnodename</span><span class="p">][</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">port</span>

                    <span class="c1"># Connect them up...</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">connnodename</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">connnodename</span><span class="p">,</span> <span class="n">ipnodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_registry_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds registry data to the graph.</span>
<span class="sd">        Assumes processes have already been plotted.</span>

<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;calls&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                    <span class="n">calls</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;calls&#39;</span><span class="p">]</span>

                    <span class="c1"># Get registry writes...</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotregistrywrites</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_registry_writes</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotregistrydeletes</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_registry_deletes</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotregistrycreates</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_registry_creates</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotregistryreads</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_registry_reads</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_registry_writes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds registry writes to the graph.</span>

<span class="sd">        :param node:  The PID node name for the calls.</span>
<span class="sd">        :param calls:  The api calls.</span>
<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">regwrites</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegSetValueExA&#39;</span><span class="p">)</span> <span class="o">|</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegSetValueExW&#39;</span><span class="p">)</span> <span class="o">|</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtSetValueKey&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                          <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">regwrite</span> <span class="ow">in</span> <span class="n">regwrites</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">regname</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">regwrite</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FullName&#39;</span><span class="p">:</span>
                    <span class="n">regname</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Buffer&#39;</span><span class="p">:</span>
                    <span class="n">regbuff</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">regname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">regnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_reg</span><span class="p">(</span><span class="n">regname</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">rwnodename</span> <span class="o">=</span> <span class="s2">&quot;REGISTRY WRITE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rwnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rwnodename</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regname</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rwnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;REGISTRYWRITE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rwnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">regwrite</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rwnodename</span><span class="p">][</span><span class="s1">&#39;buffer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regbuff</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">rwnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;REGISTRYWRITE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">rwnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">rwnodename</span><span class="p">,</span> <span class="n">regnodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_registry_deletes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds registry deletes to the graph.</span>

<span class="sd">        :param node:  The PID node name for the calls.</span>
<span class="sd">        :param calls:  The api calls.</span>
<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">regdeletes</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegDeleteValueA&#39;</span><span class="p">)</span> <span class="o">|</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegDeleteValueW&#39;</span><span class="p">)</span> <span class="o">|</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtDeleteKey&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">regdelete</span> <span class="ow">in</span> <span class="n">regdeletes</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">regname</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">regdelete</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FullName&#39;</span><span class="p">:</span>
                    <span class="n">regname</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">regname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">regnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_reg</span><span class="p">(</span><span class="n">regname</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">rdnodename</span> <span class="o">=</span> <span class="s2">&quot;REGISTRY DELETE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rdnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rdnodename</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regname</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rdnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;REGISTRYDELETE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rdnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">regdelete</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">rdnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;REGISTRYDELETE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">rdnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">rdnodename</span><span class="p">,</span> <span class="n">regnodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_registry_creates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds registry creates to the graph.</span>

<span class="sd">        :param node:  The PID node name for the calls.</span>
<span class="sd">        :param calls:  The api calls.</span>
<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">regcreates</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegCreateKeyExA&#39;</span><span class="p">)</span> <span class="o">|</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegCreateKeyExW&#39;</span><span class="p">)</span> <span class="o">|</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtCreateKey&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                           <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">regcreate</span> <span class="ow">in</span> <span class="n">regcreates</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">regname</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">regcreate</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FullName&#39;</span><span class="p">:</span>
                    <span class="n">regname</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">regname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">regnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_reg</span><span class="p">(</span><span class="n">regname</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">rcnodename</span> <span class="o">=</span> <span class="s2">&quot;REGISTRY CREATE </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rcnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rcnodename</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regname</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rcnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;REGISTRYCREATE&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rcnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">regcreate</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">rcnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;REGISTRYCREATE&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">rcnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">rcnodename</span><span class="p">,</span> <span class="n">regnodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_registry_reads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">calls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function that adds registry reads to the graph.</span>

<span class="sd">        :param node:  The PID node name for the calls.</span>
<span class="sd">        :param calls:  The api calls.</span>
<span class="sd">        :returns:  Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">regreads</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[((</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegQueryValueExA&#39;</span><span class="p">)</span> <span class="o">|</span>
                         <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RegQueryValueExW&#39;</span><span class="p">)</span> <span class="o">|</span>
                         <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;api&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NtQueryValueKey&#39;</span><span class="p">))</span> <span class="o">&amp;</span>
                         <span class="p">(</span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">regread</span> <span class="ow">in</span> <span class="n">regreads</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">regname</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">regread</span><span class="p">[</span><span class="s1">&#39;arguments&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FullName&#39;</span><span class="p">:</span>
                    <span class="n">regname</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">regname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignorepaths</span><span class="p">)</span> <span class="ow">and</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search_re</span><span class="p">(</span><span class="n">regname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">includepaths</span><span class="p">)):</span>
                    <span class="k">continue</span>
                <span class="n">regnodename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_reg</span><span class="p">(</span><span class="n">regname</span><span class="p">)</span>
                <span class="c1"># Get a sequential number for the event...</span>
                <span class="n">nextid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">)</span>
                <span class="n">rrnodename</span> <span class="o">=</span> <span class="s2">&quot;REGISTRY READ </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nextid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rrnodename</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rrnodename</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">regname</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rrnodename</span><span class="p">][</span><span class="s1">&#39;node_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;REGISTRYREAD&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">rrnodename</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span>\
                    <span class="n">regread</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">rrnodename</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;REGISTRYREAD&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">rrnodename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">rrnodename</span><span class="p">,</span> <span class="n">regnodename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_positions_digraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to create the positions of the graph.</span>

<span class="sd">        :returns: Nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create the positions...</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphvizprog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1">#  self.pos = networkx.fruchterman_reingold_layout(self.digraph)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="p">)</span>
            <span class="c1"># self.pos = networkx.circular_layout(self.digraph)</span>
            <span class="c1"># self.pos = networkx.shell_layout(self.digraph)</span>
            <span class="c1"># self.pos = networkx.spectral_layout(self.digraph)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> \
                <span class="n">networkx</span><span class="o">.</span><span class="n">drawing</span><span class="o">.</span><span class="n">nx_pydot</span><span class="o">.</span><span class="n">graphviz_layout</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graphvizprog</span><span class="p">,</span>
                    <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rootpid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generategraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to create the output data for plotly.</span>

<span class="sd">        :returns: The data that can be plotted with plotly scatter</span>
<span class="sd">            plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Node coordinates...</span>
        <span class="n">ProcessX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ProcessY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">HostX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">HostY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">IPX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">IPY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">SocketX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">SocketY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">TCPConnectX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">TCPConnectY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCreateX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCreateY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileWriteX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileWriteY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCopyX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCopyY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileDeleteX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileDeleteY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileMoveX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileMoveY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileReadX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileReadY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryWriteX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryWriteY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryDeleteX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryDeleteY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryCreateX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryCreateY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryReadX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryReadY</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Edge coordinates...</span>
        <span class="n">ProcessXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ProcessYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GetNameXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GetNameYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">DNSXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">DNSYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">SocketXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">SocketYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">TCPConnectXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">TCPConnectYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCreateXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCreateYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">LoadImageXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">LoadImageYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileWriteXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileWriteYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCopyXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileCopyYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileDeleteXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileDeleteYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileMoveXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileMoveYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileReadXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">FileReadYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryWriteXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryWriteYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryDeleteXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryDeleteYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryCreateXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryCreateYe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryReadXe</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">RegistryReadYe</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Hover Text...</span>
        <span class="n">proctxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hosttxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">iptxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sockettxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tcpconnecttxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filecreatetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filewritetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filecopytxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filedeletetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filemovetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filereadtxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">registrytxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">registrywritetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">registrydeletetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">registrycreatetxt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">registryreadtxt</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Traverse nodes...</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">:</span>
                <span class="n">ProcessX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ProcessY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="s1">&#39;cmdline&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">]:</span>
                    <span class="n">cmdline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;cmdline&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cmdline</span> <span class="o">=</span> <span class="s2">&quot;Not Available&quot;</span>
                <span class="n">proctxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;PID: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Path: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Command Line: </span><span class="si">{2}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Parent PID: </span><span class="si">{3}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;pid&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;module_path&#39;</span><span class="p">],</span>
                        <span class="n">cmdline</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;parent_id&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HOST&#39;</span><span class="p">:</span>
                <span class="n">HostX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">HostY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">hosttxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;HOST: </span><span class="si">{0}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">],</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IP&#39;</span><span class="p">:</span>
                <span class="n">IPX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">IPY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">iptxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;IP: </span><span class="si">{0}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SOCKET&#39;</span><span class="p">:</span>
                <span class="n">SocketX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">SocketY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">sockettxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Socket: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Protocol: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Open Time: </span><span class="si">{2}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Close TIme: </span><span class="si">{3}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;socket&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;protocol&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;opentime&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;closetime&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TCPCONNECT&#39;</span><span class="p">:</span>
                <span class="n">TCPConnectX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">TCPConnectY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">tcpconnecttxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;TCP Connect:&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;IP: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Port: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Socket: </span><span class="si">{2}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{3}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;ip&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;port&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;socket&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">:</span>
                <span class="n">FileX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File: </span><span class="si">{0}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILECREATE&#39;</span><span class="p">:</span>
                <span class="n">FileCreateX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileCreateY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filecreatetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File Create: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Existed Before: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Desired Access: </span><span class="si">{2}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Create Disposition: </span><span class="si">{3}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;File Atributes: </span><span class="si">{4}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{5}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;existedbefore&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;desiredaccess&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;createdisposition&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;fileattribtes&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEWRITE&#39;</span><span class="p">:</span>
                <span class="n">FileWriteX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileWriteY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filewritetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File Write: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{1}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILECOPY&#39;</span><span class="p">:</span>
                <span class="n">FileCopyX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileCopyY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filecopytxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File Copy:&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Existing File: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;New File: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Existed Before: </span><span class="si">{2}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{3}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;existingfile&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;newfile&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;existedbefore&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEDELETE&#39;</span><span class="p">:</span>
                <span class="n">FileDeleteX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileDeleteY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filedeletetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File Delete: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{1}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEMOVE&#39;</span><span class="p">:</span>
                <span class="n">FileMoveX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileMoveY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filemovetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File Move:&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Existing File: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;New File: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{2}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;existingfile&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;newfile&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEREAD&#39;</span><span class="p">:</span>
                <span class="n">FileReadX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileReadY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">filereadtxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;File Read: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{1}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;file&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRY&#39;</span><span class="p">:</span>
                <span class="n">RegistryX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">registrytxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Registry: </span><span class="si">{0}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYWRITE&#39;</span><span class="p">:</span>
                <span class="n">RegistryWriteX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryWriteY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">registrywritetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Registry Write: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Buffer: </span><span class="si">{1}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{2}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;buffer&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYDELETE&#39;</span><span class="p">:</span>
                <span class="n">RegistryDeleteX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryDeleteY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">registrydeletetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Registry Delete: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{1}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYCREATE&#39;</span><span class="p">:</span>
                <span class="n">RegistryCreateX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryCreateY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">registrycreatetxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Registry Create: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{1}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYREAD&#39;</span><span class="p">:</span>
                <span class="n">RegistryReadX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryReadY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">registryreadtxt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot;Registry Read: </span><span class="si">{0}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="s2">&quot;Time: </span><span class="si">{1}</span><span class="s2">&quot;</span>
                    <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;registry&#39;</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span>
                        <span class="p">)</span>
                               <span class="p">)</span>

        <span class="c1"># Traverse edges...</span>
        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">):</span>
                <span class="n">ProcessXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ProcessXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ProcessXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">ProcessYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ProcessYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">ProcessYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HOST&#39;</span><span class="p">):</span>
                <span class="n">GetNameXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">GetNameXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">GetNameXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">GetNameYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">GetNameYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">GetNameYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HOST&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IP&#39;</span><span class="p">):</span>
                <span class="n">DNSXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">DNSXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">DNSXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">DNSYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">DNSYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">DNSYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SOCKET&#39;</span><span class="p">):</span>
                <span class="n">SocketXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">SocketXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">SocketXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">SocketYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">SocketYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">SocketYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SOCKET&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TCPCONNECT&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TCPCONNECT&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IP&#39;</span><span class="p">)):</span>
                <span class="n">TCPConnectXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">TCPConnectXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">TCPConnectXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">TCPConnectYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">TCPConnectYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">TCPConnectYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILECREATE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILECREATE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)):</span>
                <span class="n">FileCreateXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileCreateXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileCreateXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">FileCreateYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileCreateYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileCreateYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEWRITE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEWRITE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)):</span>
                <span class="n">FileWriteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileWriteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileWriteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">FileWriteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileWriteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileWriteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">):</span>
                <span class="n">LoadImageXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">LoadImageXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">LoadImageXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">LoadImageYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">LoadImageYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">LoadImageYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILECOPY&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILECOPY&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)):</span>
                <span class="n">FileCopyXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileCopyXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileCopyXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">FileCopyYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileCopyYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileCopyYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEDELETE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEDELETE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)):</span>
                <span class="n">FileDeleteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileDeleteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileDeleteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">FileDeleteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileDeleteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileDeleteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEMOVE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEMOVE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)):</span>
                <span class="n">FileMoveXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileMoveXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileMoveXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">FileMoveYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileMoveYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileMoveYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEREAD&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILEREAD&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FILE&#39;</span><span class="p">)):</span>
                <span class="n">FileReadXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileReadXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">FileReadXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">FileReadYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileReadYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">FileReadYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYWRITE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYWRITE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRY&#39;</span><span class="p">)):</span>
                <span class="n">RegistryWriteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryWriteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryWriteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">RegistryWriteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryWriteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryWriteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYDELETE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYDELETE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRY&#39;</span><span class="p">)):</span>
                <span class="n">RegistryDeleteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryDeleteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryDeleteXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">RegistryDeleteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryDeleteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryDeleteYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYCREATE&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYCREATE&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRY&#39;</span><span class="p">)):</span>
                <span class="n">RegistryCreateXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryCreateXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryCreateXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">RegistryCreateYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryCreateYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryCreateYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYREAD&#39;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRYREAD&#39;</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;REGISTRY&#39;</span><span class="p">)):</span>
                <span class="n">RegistryReadXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryReadXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">RegistryReadXe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">RegistryReadYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryReadYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">RegistryReadYe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># PROCESSES...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">ProcNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ProcessX</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">ProcessY</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Process&#39;</span><span class="p">,</span>
                            <span class="n">text</span><span class="o">=</span><span class="n">proctxt</span><span class="p">,</span>
                            <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">ProcEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ProcessXe</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">ProcessYe</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                            <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(214,39,20)&#39;</span><span class="p">),</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Process Start&#39;</span><span class="p">,</span>
                            <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ProcNodes</span><span class="p">)</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ProcEdges</span><span class="p">)</span>

        <span class="c1"># HOSTS...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">HostNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">HostX</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">HostY</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Host&#39;</span><span class="p">,</span>
                            <span class="n">text</span><span class="o">=</span><span class="n">hosttxt</span><span class="p">,</span>
                            <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HostNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">GetNameEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">GetNameXe</span><span class="p">,</span>
                               <span class="n">y</span><span class="o">=</span><span class="n">GetNameYe</span><span class="p">,</span>
                               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                               <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(174,199,232)&#39;</span><span class="p">),</span>
                               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;DNS Query&#39;</span><span class="p">,</span>
                               <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GetNameEdges</span><span class="p">)</span>

        <span class="c1"># IPS...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">IPNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">IPX</span><span class="p">,</span>
                          <span class="n">y</span><span class="o">=</span><span class="n">IPY</span><span class="p">,</span>
                          <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                          <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                          <span class="n">name</span><span class="o">=</span><span class="s1">&#39;IP&#39;</span><span class="p">,</span>
                          <span class="n">text</span><span class="o">=</span><span class="n">iptxt</span><span class="p">,</span>
                          <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IPNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">DNSEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">DNSXe</span><span class="p">,</span>
                           <span class="n">y</span><span class="o">=</span><span class="n">DNSYe</span><span class="p">,</span>
                           <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                           <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(23,190,207)&#39;</span><span class="p">),</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;DNS Response&#39;</span><span class="p">,</span>
                           <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DNSEdges</span><span class="p">)</span>

        <span class="c1"># SOCKETS...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(277,119,194)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">SocketNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">SocketX</span><span class="p">,</span>
                              <span class="n">y</span><span class="o">=</span><span class="n">SocketY</span><span class="p">,</span>
                              <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                              <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Socket&#39;</span><span class="p">,</span>
                              <span class="n">text</span><span class="o">=</span><span class="n">sockettxt</span><span class="p">,</span>
                              <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">SocketEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">SocketXe</span><span class="p">,</span>
                              <span class="n">y</span><span class="o">=</span><span class="n">SocketYe</span><span class="p">,</span>
                              <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                              <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(227,119,194)&#39;</span><span class="p">),</span>
                              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Create Socket&#39;</span><span class="p">,</span>
                              <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SocketNodes</span><span class="p">)</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SocketEdges</span><span class="p">)</span>

        <span class="c1"># TCP CONNECTS...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(44,160,44)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">TCPConnectNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">TCPConnectX</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">TCPConnectY</span><span class="p">,</span>
                                  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                  <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TCP Connection&#39;</span><span class="p">,</span>
                                  <span class="n">text</span><span class="o">=</span><span class="n">tcpconnecttxt</span><span class="p">,</span>
                                  <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">TCPConnectEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">TCPConnectXe</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">TCPConnectYe</span><span class="p">,</span>
                                  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                  <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(44,160,44)&#39;</span><span class="p">),</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;TCP Connect&#39;</span><span class="p">,</span>
                                  <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TCPConnectNodes</span><span class="p">)</span>
        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TCPConnectEdges</span><span class="p">)</span>

        <span class="c1"># FILES...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;hexagon&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileX</span><span class="p">,</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">FileY</span><span class="p">,</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File&#39;</span><span class="p">,</span>
                            <span class="n">text</span><span class="o">=</span><span class="n">filetxt</span><span class="p">,</span>
                            <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileNodes</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(123,102,210)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileCreateNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileCreateX</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">FileCreateY</span><span class="p">,</span>
                                  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                  <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Create&#39;</span><span class="p">,</span>
                                  <span class="n">text</span><span class="o">=</span><span class="n">filecreatetxt</span><span class="p">,</span>
                                  <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileCreateNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">FileCreateEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileCreateXe</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">FileCreateYe</span><span class="p">,</span>
                                  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                  <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(123,102,210)&#39;</span><span class="p">),</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Create&#39;</span><span class="p">,</span>
                                  <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileCreateEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,187,120)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileWriteNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileWriteX</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">FileWriteY</span><span class="p">,</span>
                                 <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                 <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Write&#39;</span><span class="p">,</span>
                                 <span class="n">text</span><span class="o">=</span><span class="n">filewritetxt</span><span class="p">,</span>
                                 <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileWriteNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">FileWriteEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileWriteXe</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">FileWriteYe</span><span class="p">,</span>
                                 <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                 <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,187,120)&#39;</span><span class="p">),</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Write&#39;</span><span class="p">,</span>
                                 <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileWriteEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(65,68,81)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileCopyNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileCopyX</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">FileCopyY</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Copy&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="n">filecopytxt</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileCopyNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">FileCopyEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileCopyXe</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">FileCopyYe</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(65,68,81)&#39;</span><span class="p">),</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Copy&#39;</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileCopyEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,128,14)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileDeleteNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileDeleteX</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">FileDeleteY</span><span class="p">,</span>
                                  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                  <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Delete&#39;</span><span class="p">,</span>
                                  <span class="n">text</span><span class="o">=</span><span class="n">filedeletetxt</span><span class="p">,</span>
                                  <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileDeleteNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">FileDeleteEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileDeleteXe</span><span class="p">,</span>
                                  <span class="n">y</span><span class="o">=</span><span class="n">FileDeleteYe</span><span class="p">,</span>
                                  <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                  <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,128,14)&#39;</span><span class="p">),</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Delete&#39;</span><span class="p">,</span>
                                  <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileDeleteEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(171,171,171)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileMoveNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileMoveX</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">FileMoveY</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Move&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="n">filemovetxt</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileMoveNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">FileMoveEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileMoveXe</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">FileMoveYe</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(171,171,171)&#39;</span><span class="p">),</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Move&#39;</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileMoveEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-up&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(207,207,207)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">FileReadNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileReadX</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">FileReadY</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Read&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="n">filereadtxt</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileReadNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">FileReadEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">FileReadXe</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">FileReadYe</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(207,207,207)&#39;</span><span class="p">),</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Read&#39;</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileReadEdges</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">LoadImageEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">LoadImageXe</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">LoadImageYe</span><span class="p">,</span>
                                 <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                 <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                           <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">),</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Process Load Image&#39;</span><span class="p">,</span>
                                 <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LoadImageEdges</span><span class="p">)</span>

        <span class="c1"># REGISTRY...</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">RegistryNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryX</span><span class="p">,</span>
                                <span class="n">y</span><span class="o">=</span><span class="n">RegistryY</span><span class="p">,</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry&#39;</span><span class="p">,</span>
                                <span class="n">text</span><span class="o">=</span><span class="n">registrytxt</span><span class="p">,</span>
                                <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryNodes</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,187,120)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">RegistryWriteNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryWriteX</span><span class="p">,</span>
                                     <span class="n">y</span><span class="o">=</span><span class="n">RegistryWriteY</span><span class="p">,</span>
                                     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Write&#39;</span><span class="p">,</span>
                                     <span class="n">text</span><span class="o">=</span><span class="n">registrywritetxt</span><span class="p">,</span>
                                     <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryWriteNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">RegistryWriteEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryWriteXe</span><span class="p">,</span>
                                     <span class="n">y</span><span class="o">=</span><span class="n">RegistryWriteYe</span><span class="p">,</span>
                                     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                     <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,187,120)&#39;</span><span class="p">),</span>
                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Write&#39;</span><span class="p">,</span>
                                     <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryWriteEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,128,14)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">RegistryDeleteNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryDeleteX</span><span class="p">,</span>
                                      <span class="n">y</span><span class="o">=</span><span class="n">RegistryDeleteY</span><span class="p">,</span>
                                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Delete&#39;</span><span class="p">,</span>
                                      <span class="n">text</span><span class="o">=</span><span class="n">registrydeletetxt</span><span class="p">,</span>
                                      <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryDeleteNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">RegistryDeleteEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryDeleteXe</span><span class="p">,</span>
                                      <span class="n">y</span><span class="o">=</span><span class="n">RegistryDeleteYe</span><span class="p">,</span>
                                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                      <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(255,128,14)&#39;</span><span class="p">),</span>
                                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Delete&#39;</span><span class="p">,</span>
                                      <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryDeleteEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-down&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(123,102,210)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">RegistryCreateNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryCreateX</span><span class="p">,</span>
                                      <span class="n">y</span><span class="o">=</span><span class="n">RegistryCreateY</span><span class="p">,</span>
                                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Create&#39;</span><span class="p">,</span>
                                      <span class="n">text</span><span class="o">=</span><span class="n">registrycreatetxt</span><span class="p">,</span>
                                      <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryCreateNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">RegistryCreateEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryCreateXe</span><span class="p">,</span>
                                      <span class="n">y</span><span class="o">=</span><span class="n">RegistryCreateYe</span><span class="p">,</span>
                                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                      <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(123,102,210)&#39;</span><span class="p">),</span>
                                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Create&#39;</span><span class="p">,</span>
                                      <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryCreateEdges</span><span class="p">)</span>

        <span class="n">marker</span> <span class="o">=</span> <span class="n">Marker</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;triangle-up&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(207,207,207)&#39;</span><span class="p">)</span>

        <span class="c1"># Create the nodes...</span>
        <span class="n">RegistryReadNodes</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryReadX</span><span class="p">,</span>
                                    <span class="n">y</span><span class="o">=</span><span class="n">RegistryReadY</span><span class="p">,</span>
                                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Registry Read&#39;</span><span class="p">,</span>
                                    <span class="n">text</span><span class="o">=</span><span class="n">registryreadtxt</span><span class="p">,</span>
                                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>

        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryReadNodes</span><span class="p">)</span>

        <span class="c1"># Create the edges for the nodes...</span>
        <span class="n">RegistryReadEdges</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RegistryReadXe</span><span class="p">,</span>
                                    <span class="n">y</span><span class="o">=</span><span class="n">RegistryReadYe</span><span class="p">,</span>
                                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                                    <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(207,207,207)&#39;</span><span class="p">),</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;File Read&#39;</span><span class="p">,</span>
                                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

        <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RegistryReadEdges</span><span class="p">)</span>

        <span class="c1"># Reverse the order and mush...</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">edges</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="n">nodes</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Return the plot data...</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_generateannotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal function to generate annotations on the graph.</span>

<span class="sd">        :returns: A list of annotations for plotly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="n">Annotations</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PID&#39;</span><span class="p">:</span>
                <span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Annotation</span><span class="p">(</span>
                        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">&lt;br&gt;PID: </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span>
                            <span class="p">),</span>
                        <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
                        <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span>
                        <span class="n">ay</span><span class="o">=-</span><span class="mi">40</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HOST&#39;</span><span class="p">:</span>
                <span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Annotation</span><span class="p">(</span>
                        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;HOST: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;host&#39;</span><span class="p">]</span>
                            <span class="p">),</span>
                        <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
                        <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span>
                        <span class="n">ay</span><span class="o">=-</span><span class="mi">40</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IP&#39;</span><span class="p">:</span>
                <span class="n">annotations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Annotation</span><span class="p">(</span>
                        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;IP: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nodemetadata</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span>
                            <span class="p">),</span>
                        <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">xref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
                        <span class="n">yref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span>
                        <span class="n">ay</span><span class="o">=-</span><span class="mi">40</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">annotations</span>

<div class="viewcode-block" id="CuckooJSONReport.plotgraph"><a class="viewcode-back" href="../../../Visualize_Logs.objects.html#Visualize_Logs.objects.CuckooJSONReport.CuckooJSONReport.plotgraph">[docs]</a>    <span class="k">def</span> <span class="nf">plotgraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                  <span class="n">graphvizprog</span><span class="o">=</span><span class="s1">&#39;sfdp&#39;</span><span class="p">,</span>
                  <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;temp-plot.html&#39;</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">image_filename</span><span class="o">=</span><span class="s1">&#39;plot_image&#39;</span><span class="p">,</span>
                  <span class="n">image_height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="mi">800</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Function to plot the graph of the ProcMon CSV.</span>

<span class="sd">        :param graphvizprog: The graphviz program to use for layout, valid</span>
<span class="sd">            options are &#39;dot&#39;, &#39;neato&#39;, &#39;twopi&#39;, &#39;circo&#39;, &#39;fdp&#39;,</span>
<span class="sd">            &#39;sfdp&#39;, &#39;patchwork&#39;, and &#39;osage&#39;.  Graphviz is REQUIRED to be</span>
<span class="sd">            installed and in your path to use this library!  The associated</span>
<span class="sd">            layout programs must be available in your path as well.  More</span>
<span class="sd">            information for the layout types can be found here:</span>
<span class="sd">            http://www.graphviz.org/Documentation.php</span>
<span class="sd">            If this value is None, the internal networkx layout algorithms</span>
<span class="sd">            will be used.</span>
<span class="sd">        :param filename: A file name for the interactive HTML plot.</span>
<span class="sd">        :param title: A title for the plot.</span>
<span class="sd">        :param auto_open: Set to false to not open the file in a web browser.</span>
<span class="sd">        :param image: An image type of &#39;png&#39;, &#39;jpeg&#39;, &#39;svg&#39;, &#39;webp&#39;, or None.</span>
<span class="sd">        :param image_filename: The file name for the exported image.</span>
<span class="sd">        :param image_height: The number of pixels for the image height.</span>
<span class="sd">        :param image_width: The number of pixels for the image width.</span>
<span class="sd">        :returns: Nothing</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphvizprog</span> <span class="o">=</span> <span class="n">graphvizprog</span>

        <span class="c1"># Layout the positions...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_positions_digraph</span><span class="p">()</span>

        <span class="n">outputdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generategraph</span><span class="p">()</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generateannotations</span><span class="p">()</span>

        <span class="c1"># Hide axis line, grid, ticklabels and title...</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">zeroline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">showticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">plotlayout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                            <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
                            <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
                            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
                            <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">)</span>

        <span class="n">plotfigure</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">outputdata</span><span class="p">,</span>
                            <span class="n">layout</span><span class="o">=</span><span class="n">plotlayout</span><span class="p">)</span>

        <span class="c1"># Plot without the plotly annoying link...</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">plotfigure</span><span class="p">,</span> <span class="n">show_link</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
             <span class="n">auto_open</span><span class="o">=</span><span class="n">auto_open</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
             <span class="n">image_filename</span><span class="o">=</span><span class="n">image_filename</span><span class="p">,</span>
             <span class="n">image_height</span><span class="o">=</span><span class="n">image_height</span><span class="p">,</span>
             <span class="n">image_width</span><span class="o">=</span><span class="n">image_width</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Keith J. Jones.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.8</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>